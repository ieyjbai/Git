# 第一章 什么是 Git ?


## 一、基本概念
### 1. SHA1
#### 定义
**SHA1** 是一种密码学中的哈希算法，任何内容能够通过该算法映射成一个 160 位的二进制数字，通常用 40 个字符(40-digit)表示。不同的内容生成的字符串是不同的。
#### 优点
* Git 使用内容的 SHA1 编码作为对象名，可以很快判断两个对象是否相同；
* Git 可以通过检查对象内容的 SHA1 编码和对象名是否相同来判断对象内容是否正确。


### 2. 对象
对象包括 3 部分：类型、大小、内容。
共有 4 种对象：
* blob
* tree
* commit
* tag

### 3. Blob 对象
**Blob 对象：**用来存储文件内容，就是二进制数据。
![blob](images/blob.png)

**查看 blob 对象**
```
$ git show 6ff87c4664
```
**注：**如两个文件在一个目录树(或是一个版本仓库)中有同意的数据内容，那么它们会共享同一个blob对象

### 4. Tree 对象
**Tree 对象：**有一串(bunch) 指向 blob 对象或是其他 tree 对象的指针，它一般用来表示内容之间的目录层次关系
![tree](images/tree.png)

每一个 tree 条目包括：mode、对象类型、SHA1值和名字。
所有的 mode 位都是 644 或 755，这表示 Git 只关心文件的可执行位。

### 5. Commit 对象
**Commit 对象：**指向一个 tree对象，并带有相关的描述信息。
![commit](images/commit.png)
#### Commit 的组成部分：
* 一个 tree 对象：tree 对象的 SHA1 签名，代表目录在某一时间点的内容；
* 父对象：是一个提交的 SHA1 签名。代表当前提交前一步的项目历史：
    * 合并的提交可能有不止一个父对象。
    * 如果提交没有父对象，称为“根提交”，代表项目最初的版本(reision).
    * 每个项目必须至少有一个“根提交”。有多个“根提交”的项目不常见，也不好。
* 作者：此次修改人的名字和日期
* 提交者：实际提交人的名字和日期
* 注释：用于描述此次提交

#### 提交的特点
* 一个提交中没有任何修改信息，修改信息是和 parents 比较得来的
* git 可以检测文件内容不变而路径改变的情况，但不会显式记录文件更名操作

### 6. 对象模型示例

### 7. 标签对象

### 8. Git 目录 与工作目录
#### 1> Git 目录
**Git 目录：**为你的项目存储所有历史和源信息的目录-包括所有对象，以及这些对象指向的分支。
##### 特点：
* 每个项目只能有一个 Git 目录；
* 默认在项目根目录下，名为 .git
* 查看 .git 结构???

#### 2> 工作目录
**工作目录：**存储现在签出(checkout)的用来编辑的文件。
对比：
* 所有的历史信息都保存在 'Git 目录'中
* 工作目录只是用来临时保存签出文件的地方
* 当你在项目的不同分支间切换时，工作目录里的文件经常会替换和删除
* 你可以编辑工作目录中的文件直到下次提交为止

### 9. Git 索引

## 二、安装与初始化
### 1. 安装

### 2. 初始化
1. 设置名字和 email，这是你提交时的签名
  ```
    git config --global user.name "bai yu jing"
    git config --global user.email "ieyjbai@sina.cn"
  ```
  **注：**全局设置会影响此用户建立的每一个项目
2. 执行后，主目录下会建立一个 ~/.gitconfig 的文件，内容如下：
  ```
  [user]
    name = bai yu jing
    email = ieyjbai@sina.cn
  ```
3. 如果不带 --global 选项，将会在项目目录下 .git/config 文件中增加 [user] 内容。本项目将使用此签名。

## 三、创建 git 仓库
### 1. 初始化一个新的仓库
1. 创建项目目录
2. 在目录中添加项目文件
3. 进入项目目录，执行命令：`git init`
**注：**项目目录下会有一个 .git 目录被创建，这表示一个仓库被初始化了。

### 2. 克隆一个仓库
通过一个项目仓库的地址 URL 获得项目的一个拷贝。Git 支持多种协议，包括：ssh://,http(s)://,git://，或只是通过一个用户名为前缀(ssh协议)。
1. 执行命令：`git clone http://xxx.git`
2. Git 会把 "Git URL" 里目录名的后缀 '.git' 去掉，作为新克隆项目的目录名。

## 四、常用操作
### 1. 修改与提交

### 2. 分支与合并

### 3. 查看日志

### 4. 比较提交

### 5. 分布式的工作流程
#### 普通方式
1. 如果 A 在 home/A/project 上新建了一个 git 仓库； B 的工作目录也在同一机器上，他们要协同工作。
2. B 首先克隆该项目到自己的工作目录：
  ```
  git clone home/A/project bProject
  ```
3. B 对项目内容进行修改，并在本地提交
  ```
  git commit -a
  ```
4. B 提交后， 通知 A 可以从仓库 home/B/bProject 中把他的修改拉(pull) 下来，于是，A 执行了如下命令，将 B 的主分支合并到 A 的当前分支里(如果 A 也做了修改，可能要手工去修复冲突，master是默认的)。
  ```
  cd /home/B/bProject
  git pull /home/A/project master
  ```
#### 分解方式
4. A 可以先wei































***
